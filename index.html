<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <title>Cattle Result</title>
    <style src="style.css"></style>

</head>

<body>

    <div id="overlay">
        <div class="loader"></div>
    </div>

    <div class="container">

        <div class="choose-lang-box mb-4">
            <strong>ğŸŒ Language:</strong>
            <select id="lang" name="language">
                <option value="en">English</option>
                <option value="ta">Tamil</option>
                <option value="hi">Hindi</option>
                <option value="kn">Kannada</option>
            </select>
        </div>

        <div class="card-modern mb-4">
            <h4 class="section-title text-center mb-3">ğŸ“¤ Upload Cow Image</h4>

            <input type="file" id="fileInput" accept="image/*" class="form-control mb-3">
            <img id="preview" src="#">

            <input type="text" id="height" class="form-control mt-3" placeholder="Enter Person Height (in cm)">
            <button class="btn btn-primary w-100 mt-3" onclick="uploadImage()">Analyze</button>
        </div>

        <div class="card-modern">
            <h4 class="section-title text-center">ğŸ“Š Result</h4>
            <div id="result" class="mt-3"></div>
        </div>

    </div>

    <!-- âœ… Your JS logic (unchanged) -->
    <script>
        const fileInput = document.getElementById('fileInput');
        const heightInput = document.getElementById('height');
        const preview = document.getElementById('preview');
        const resultDiv = document.getElementById('result');
        const lang = document.getElementById('lang');

        fileInput.addEventListener('change', () => {
            const file = fileInput.files[0];
            const reader = new FileReader();
            reader.onload = () => {
                preview.style.display = "block";
                preview.src = reader.result;
            }
            if (file) reader.readAsDataURL(file);
        });

        function uploadImage() {
            document.getElementById("overlay").style.display = "flex";
            const file = fileInput.files[0];
            if (!file) return alert("Please select an image.");

            let formData = new FormData();
            formData.append("image", file);
            formData.append("person_height", heightInput.value);
            formData.append("lang", lang.value);

            fetch("http://localhost:8080/upload", {
                method: "POST",
                body: formData
            })
                .then(res => res.json())
                .then(data => {
                    let items = "";
                    data.diagnosis_report.report.forEach((item) => {
                        items += `
             <div class='pt-3'>
                 <strong>Label:</strong> ${item.label || "Unavailable"} <br>
                 <strong>Confidence:</strong> ${item.confidence || "Unavailable"} 
                 <div class="ai-box">${item.ai_recommendations || "No recommendations available"}</div>
             </div>`;
                    });

                    resultDiv.innerHTML = `
            <p><strong>Warning:</strong> ${data.warning || "No Warning"}</p>
            <p><strong>Cow Found:</strong> ${data.cow_found ? "âœ… Yes" : "âŒ No"}</p>
            <p><strong>Breed:</strong> ${data.cow_breed}</p>
            <p><strong>Estimated Weight:</strong> ${data.estimated_approximate_weight || "Not Available"}</p>
            <p><strong>Udder Found:</strong> ${data.udder_found ? "âœ… Yes" : "âŒ No"}</p>
            <p><strong>Milk Yield:</strong> ${data.milk_yield || "Not Available"}</p>

            <h5 class="mt-4">ğŸ§ª Diagnosis Summary</h5>
            ${items}
        `;
                })
                .finally(() => {
                    document.getElementById("overlay").style.display = "none";
                })
        }
    </script>
</body>

</html>